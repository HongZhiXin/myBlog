---
title: 浏览器是如何渲染网页的
date: 2023-02-08 15:15:09
tags: 
- 面试 
- 浏览器原理
categories: 
- 浏览器原理
---


## 浏览器如何进行渲染的
dom树、cssom树合并渲染树的图解
> ![渲染树](https://chinese.freecodecamp.org/news/content/images/2020/11/image-15.png)
<!-- more -->
> 1. 解析 HTML：浏览器会把 HTML 文档解析成一棵 DOM（文档对象模型）树
> 2. 解析 CSS：浏览器会读取 CSS 文件并应用到 DOM 树上，产生一棵 CSSOM（CSS 对象模型）树
> 3. 合并 DOM 和 CSSOM：浏览器会把 DOM 和 CSSOM 合并成一棵渲染树（Rendering Tree），这棵树描述了每个元素的布局、绘制信息
> 4. 布局：浏览器遍历渲染树，计算每个元素的位置和大小。
> 5. 绘制：浏览器会按照渲染树绘制每个元素，并最终显示在屏幕上。



## 重绘 Repaint
当页面元素样式的改变不影响元素在文档流中的位置时（例如background-color,border-color,visibility）,浏览器只会将新样式赋予元素并进行重绘操作。


## 回流(重排) Reflow
当改变影响文档内容或者结构，或者元素位置时，回流操作就会被触发，一般有以下几种情况： 
> - DOM操作（对元素的增删改，顺序变化等）
> - 内容变化，包括表单区域内的文本改变
> - CSS属性的更改或重新计算
> - 增删样式表内容
> - 修改class属性
> - 浏览器窗口变化（滚动或缩放）
> - 伪类样式激活（:hover等）

## 浏览器如何优化渲染
了解了重绘和回流之后，优化浏览器渲染的原理就是建立在如何减少重绘和回流
> - 减少DOM的操作，不必要的时候不进行DOM操作
> - 布局的时候考虑重排，尽可能的只更改该块区域而其他区域不受影响
> 例如一个position设置为absolute/fixed的元素的更改只会影响其本身和其子元素，而static的元素变化则会影响其之后的所有页面元素。
> - 修改元素样式时，更改其class属性是性能最高的方法。选择器越有针对性越好（这同样也有助于分离页面样式和逻辑）
> - 使用现代化前端ui框架如vue和react等，它们的虚拟dom理念使得多次回流和重绘操作合并成一次进行。

---

## 用户输入地址后发生了什么？（简单版本）
此问题也可以延伸为  **"用户输入地址后发生了什么"？**， 详细的版本将在下期展现
> 1. DNS域名解析
> 2. 浏览器与服务器建立TCP连接
> 3. 浏览器发起HTTP请求
> 4. 服务器响应HTTP请求，并返回该页面的HTML内容
> 5. 浏览器解析HTML代码，并请求HTML代码的中的资源（如js、css、图片等等）
> 6. 浏览器把页面呈现给用户




